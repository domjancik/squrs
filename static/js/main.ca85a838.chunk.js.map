{"version":3,"sources":["firebaseConfig.ts","Button/Button.tsx","Help/Help.tsx","Intro/Intro.tsx","Squr/ConfigContext.ts","Squr/ConfigContextProvider.tsx","Squr/SequencerContent.tsx","Squr/EmptySqur.tsx","Squr/useAnimationFrame.ts","Visualizer/Visualizer.tsx","Squr/notes.ts","Squr/ExpressionContent.tsx","Squr/functions.ts","Squr/useExpressionWithSound.ts","Squr/Squr.tsx","Squr/SqurFirebase.tsx","Squr/TimeContext.tsx","Squr/useExpressionSequencer.ts","useTime.ts","App.tsx","reportWebVitals.ts","index.tsx"],"names":["firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","cssSqur","css","Button","children","rest","cssHelp","cssHelpContent","variables","title","value","functions","renderHelpItems","items","itemElements","map","Help","useState","open","setOpen","helpContent","onClick","o","cssIntro","Intro","ConfigContext","createContext","volume","ConfigContextProvider","useRef","useEffect","window","setVolume","newVolume","current","Provider","SequencerToggle","side","active","label","style","width","height","background","SequencerContent","res","expression","setExpression","extra","currentStep","step","steps","split","str","val","isNaN","toggleSide","toggles","index","stepIndex","updatedSteps","join","setStep","sqr","EmptySqur","color","borderRadius","padding","boxSizing","boxShadow","useAnimationFrame","callback","requestRef","React","previousTimeRef","animate","time","deltaTime","requestAnimationFrame","cancelAnimationFrame","Visualizer","values","Array","fill","valuesState","setValuesState","v","slice","length","push","path","Math","abs","viewBox","preserveAspectRatio","d","strokeWidth","stroke","vectorEffect","C","F","G","Bb","notes","getNote","i","note","octave","floor","renderVariables","pipe","collect","key","cssExtra","ExpressionContent","fontColor","error","instrumentName","fontFamily","border","fontWeight","transition","maxWidth","minWidth","minHeight","maxHeight","onChange","e","target","fontSize","description","normalizedSin","x","sin","PI","normalizedTriangle","normalizedSquare","phase","invert","lerp","from","to","alpha","normalizedStep","position","len","pos","useExpressionWithSound","useContext","setRes","resRef","lastValidCompiled","parseError","compile","prevRes","synth","Tone","toDestination","disconnect","dispose","osc","frequency","toFrequency","type","detune","random","start","loop","exprEvalRes","t","tri","stp","inv","max","min","triggerAttackRelease","volumeTarget","Infinity","rampTo","Squr","a","init","expressionExternal","setExpressionExternal","contentComponent","useExpressionHook","expressionInternal","setExpressionInternal","black","ContentComponent","SqurFirebase","ref","useDatabase","useDatabaseObjectData","data","status","localExpression","setLocalExpression","expr","newExpression","set","TimeContext","useExpressionSequencer","mappedSteps","noise","loopA","round","playing","stop","useTime","setTime","ut","SIDE","getXIndex","perRow","getYIndex","dynamicFirebaseSqurs","SQURS_PER_ROW","_v","isSequencer","content","undefined","processing","y","App","started","setStarted","display","alignItems","justifyContent","gridTemplateColumns","gap","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.ca85a838.chunk.js","sourcesContent":["const firebaseConfig = {\n  apiKey: \"AIzaSyA6miG1egwhyCpNcBdr-R8P3flUJP8VLj4\",\n  authDomain: \"squr-d2ae8.firebaseapp.com\",\n  databaseURL:\n    \"https://squr-d2ae8-default-rtdb.europe-west1.firebasedatabase.app\",\n  projectId: \"squr-d2ae8\",\n  storageBucket: \"squr-d2ae8.appspot.com\",\n  messagingSenderId: \"25610237851\",\n  appId: \"1:25610237851:web:8b825f5e7ab2363cd2533e\",\n};\n\nexport default firebaseConfig;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react'\n\nimport React, { ReactElement } from 'react'\n\ninterface Props extends React.DetailedHTMLProps<React.ButtonHTMLAttributes<HTMLButtonElement>, HTMLButtonElement> {\n    \n}\n\nconst cssSqur = css`\n    border-radius: 0.5em;\n    padding: 0.5em;\n    box-sizing: border-box;\n    box-shadow: inset 0em -.2em .5em #abc;\n    background: transparent;\n    color: #abc;\n    border: none;\n    transition: all 500ms;\n\n    &:hover {\n        box-shadow: inset 0em .2em .5em #abc;\n    }\n`\n\nfunction Button({children, ...rest}: Props): ReactElement {\n    return (\n            <button css={cssSqur} {...rest}>{children}</button>\n    )\n}\n\nexport default Button\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react'\n\n\nimport React, { ReactElement, useState } from 'react'\nimport Button from '../Button/Button'\n\ninterface Props {\n    \n}\n\nconst cssHelp = css`\n    position: fixed;\n    left: 2em;\n    top: 2em;\n`\n\nconst cssHelpContent = css`\n    background: rgba(0,0,0, 0.5);\n    color: #abc;\n    border-radius: 0.5em;\n    padding: 1em;\n    pointer-events: none;\n`\n\ntype HelpItem = {\n    title: string\n    value: string\n}\n\nconst variables: HelpItem[] = [\n    {\n        title: 't',\n        value: 'time in secs'\n    },\n    {\n        title: 'i',\n        value: 'index of squr - 1, 2, 3...'\n    },\n    {\n        title: 'x',\n        value: 'x index of squr'\n    },\n    {\n        title: 'y',\n        value: 'y index of squr'\n    },\n]\n\nconst functions: HelpItem[] = [\n    {\n        title: 'sin(x)',\n        value: 'sine with 0-1 cycle input and 0-1 output'\n    },\n    {\n        title: 'tri(x)',\n        value: 'triangle with 0-1 cycle input and 0-1 output'\n    },\n    {\n        title: 'sqr(x, phase?)',\n        value: 'square with 0-1 cycle input, optional phase'\n    },\n    {\n        title: 'stp(x, a, b, c, ...)',\n        value: 'step sequencer with 0-1 cycle input'\n    },\n]\n\nconst renderHelpItems = (items: HelpItem[]) => {\n    const itemElements = items.map(({title, value}) => <li key={title+value}><strong>{title}:</strong> {value}</li>)\n    return <ul>{itemElements}</ul>\n}\n\nfunction Help({}: Props): ReactElement {\n    const [open, setOpen] = useState(true)\n\n    const helpContent = (<div css={cssHelpContent}>\n                <p>make the squrs sing and shine with math expressions</p>\n                <p>all is syncd, tell friends</p>\n                <h3>Variables</h3>\n                {renderHelpItems(variables)}\n                <h3>Functions</h3>\n                {renderHelpItems(functions)}\n            </div>)\n\n    return (\n        <div css={cssHelp}>\n            <div>\n                <Button onClick={() => setOpen(o => !o)}>?</Button>\n            </div>\n            {open && helpContent}\n        </div>\n    )\n}\n\nexport default Help\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react'\n\nimport React, { ReactElement } from 'react'\nimport Button from '../Button/Button'\n\n\nconst cssIntro = css`\n    color: white;\n    text-align: center;\n` \n\ninterface Props {\n    onClick: (event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void\n}\n\nfunction Intro({onClick}: Props): ReactElement {\n    return (\n        <div css={cssIntro}>\n            <h1>SQUR!</h1>\n            <div><Button onClick={onClick}>‚ñ°‚ñ° start ‚ñ°‚ñ°</Button></div>\n            <div>\n                <small>gotta make you click to make sounds, aight, domj</small>\n            </div>\n        </div>\n    )\n}\n\nexport default Intro\n","import { createContext } from \"react\";\n\nconst ConfigContext = createContext<{volume: React.MutableRefObject<number> | null}>({volume: null})\n\nexport default ConfigContext\n","import React, { ReactElement, ReactNode, useEffect, useRef } from 'react'\nimport ConfigContext from './ConfigContext'\n\ninterface Props {\n    children: ReactNode\n}\n\nfunction ConfigContextProvider({children}: Props): ReactElement {\n\n    const volume = useRef(1)\n\n    useEffect(() => {\n        // @ts-ignore\n        window.setVolume = (newVolume: number) => volume.current = newVolume\n        return () => {\n            // @ts-ignore\n            delete window.setVolume\n        }\n    }, [])\n\n    return (\n        <ConfigContext.Provider value={{ volume: volume }} >\n            {children}\n        </ConfigContext.Provider>\n    )\n}\n\nexport default ConfigContextProvider\n","import React, { ReactElement } from 'react'\nimport Button from '../Button/Button'\nimport ContentProps from './ContentProps'\n\nfunction SequencerToggle({ value, onClick, side, active }: { value: number, onClick: () => void, side: string | number, active: boolean }) {\n    // const label = on ? '‚ô•' : 'üñ§'\n\n    let label = 'üñ§'\n    if (value >= 0.25) label = 'üíî'\n    if (value >= 0.5) label = 'üß°'\n    if (value >= 0.75) label = 'üíñ'\n    if (value >= 1) label = 'üíù'\n    \n    return <Button onClick={onClick} style={{width: side, height: side, background: active ? '#abc' : 'transparent'}}>{label}</Button>\n}\n\nfunction SequencerContent({res, expression, setExpression, side, extra}: ContentProps): ReactElement {\n    // const steps = 8\n    const currentStep = extra?.step || 0\n\n    // TODO share with usesequencer\n    const mappedSteps = expression.split(',').map(str => {\n        const val = +str\n        return isNaN(val) ? 0 : val\n    })\n\n    const steps = mappedSteps || [0]\n\n    const setStep = (stepIndex: number, value: number) => {\n        const updatedSteps = [...steps]\n        updatedSteps[stepIndex] = value\n        setExpression(updatedSteps.join(','))\n    }\n\n    const toggleSide =`calc(${side} / 4 - 5px)`\n    const toggles = steps.map((step, index) => {\n        return <SequencerToggle active={currentStep === index} side={toggleSide} key={index} value={step} onClick={() => setStep(index, (step + 0.25) % 1)} />\n    })\n\n    return (\n        <div>\n            {toggles}\n        </div>\n    )\n}\n\nexport default SequencerContent\n","import React, { ReactElement, ReactNode } from 'react'\n\ninterface Props {\n    color: { background: string }\n    children: ReactNode\n    side: number | string\n}\n\nconst sqr = (side: number | string) => ({\n    width: side,\n    height: side\n})\n\nfunction EmptySqur({color, children, side}: Props): ReactElement {\n    return (\n        <div style={\n            {\n                ...{borderRadius: '0.5em', padding: '0.5em', boxSizing: 'border-box', boxShadow: 'inset 0em -.2em .5em #abc'},\n                ...sqr(side),\n                ...color,\n            }\n        }>\n            {children}\n        </div>\n    )\n}\n\nexport default EmptySqur\n","import React from 'react'\n\nconst useAnimationFrame = (callback: (time: number) => void) => {\n  // Use useRef for mutable variables that we want to persist\n  // without triggering a re-render on their change\n  const requestRef = React.useRef<number>();\n  const previousTimeRef = React.useRef<number>();\n\n  const animate = (time: number) => {\n    if (!!previousTimeRef.current) {\n      const deltaTime = time - previousTimeRef.current;\n      callback(deltaTime);\n    }\n    previousTimeRef.current = time;\n    requestRef.current = requestAnimationFrame(animate);\n  };\n\n  React.useEffect(() => {\n    requestRef.current = requestAnimationFrame(animate);\n    return () => cancelAnimationFrame(requestRef.current!);\n    /* eslint-disable react-hooks/exhaustive-deps */\n  }, []); // Make sure the effect runs only once\n};\n\nexport default useAnimationFrame;\n","import React, { ReactElement, useRef, useState } from 'react'\nimport useAnimationFrame from '../Squr/useAnimationFrame'\n\ninterface Props {\n    value: number\n}\n\nfunction Visualizer({value}: Props): ReactElement {\n    const values = useRef<number[]>(Array(30).fill(0))\n    const [valuesState, setValuesState] = useState(values.current)\n\n    const v = useRef(0)\n    v.current = value\n\n    useAnimationFrame(() => {\n        values.current = values.current.slice(1, values.current.length)\n        values.current.push(v.current)\n        setValuesState(values.current)\n    })\n\n    const path = valuesState\n        .map((val, index) => `L${index * 1} ${100 - (Math.abs(val) * 90 + 5)}`)\n        .join(' ')\n\n    return (\n        <div style={{width: '100%'}}>\n            <svg height=\"30\" width=\"100%\" viewBox=\"0 0 30 100\" preserveAspectRatio=\"none\">\n                <path d={`M-5 0 ${path}`} strokeWidth=\"2\" stroke=\"currentColor\" fill=\"none\" vectorEffect=\"non-scaling-stroke\" />\n            </svg>\n        </div>\n    )\n}\n\nexport default Visualizer\n","import * as Tone from 'tone'\n\n// const notes = ['C', 'G', 'D', 'A', 'E']\n// const notes = ['C', 'D', 'E', 'A', 'G']\n\nconst C = 'C'\nconst D = 'D'\nconst E = 'E'\nconst Eb = 'Eb'\nconst F = 'F'\nconst G = 'G'\nconst A = 'A'\nconst Ab = 'Ab'\nconst B = 'B'\nconst Bb = 'Bb'\n\nconst SCALE_5_MAJOR_PENTATONIC = [C, D, E, G, A]\nconst SCALE_5_EGYPTIAN_SUSPENDED = [C, D, F, G, Bb]\n// const SCALE_5_BLUES_MINOR_MAN_GONG = [C, Eb, F, Ab, Bb, C]\nconst SCALE_5_BLUES_MINOR_MAN_GONG = [C, Eb, F, Ab, Bb]\nconst SCALE_5_BLUES_MAJOR_RITSUSEN = [C, D, F, G, A]\nconst SCALE_5_MINOR_PENTATONIC = [C, Eb, F, G, Bb]\nconst SCALE_4_TONEJS_SEQUENCER_EXAMPLE = [A, 'Db', E, 'Gb']\nconst notes = SCALE_5_EGYPTIAN_SUSPENDED\n\nconst getNote = (i: number) => {\n    const note = notes[i % notes.length]\n    const octave = Math.floor(i / notes.length)\n    return `${note}${octave + 2}`\n}\n// const getNote = (i: number) => `C${i}`\nconst getNoteFrequency = (i: number) => Tone.Frequency(getNote(i)).toFrequency()\n\nexport { getNote, getNoteFrequency }","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react'\nimport { pipe } from 'fp-ts/lib/function'\nimport { collect } from 'fp-ts/lib/Record'\nimport React, { ReactElement } from 'react'\nimport Visualizer from '../Visualizer/Visualizer'\nimport ContentProps from './ContentProps'\nimport { getNote } from './notes'\n\nconst renderVariables = (variables: {[key: string]: number}) => {\n    return pipe(\n        variables,\n        collect((key, value) => <span><strong> {key}:</strong>{value}</span>)\n    )\n}\n\nconst cssExtra = css`\n    opacity: 0.3;\n    transition: all 500ms;\n    &:hover {\n        opacity: 1;\n    }\n`\n\nfunction ExpressionContent({expression, setExpression, res, fontColor, variables, error, instrumentName}: ContentProps): ReactElement {\n    return (\n        <>\n            <textarea\n                style={{fontFamily: 'monospace', borderRadius: '0.3em', padding: '0.5em', boxSizing: 'border-box', border: 'none', width: '100%', boxShadow: 'inset 0em .2em .5em #abc', background: 'transparent', color: fontColor, fontWeight: 'bold', transition: 'all 300ms', maxWidth: '100%', minWidth: '100%', minHeight: '50%', maxHeight: '100%'}}\n                value={expression} onChange={e => setExpression(e.target.value)}\n            />\n            <div css={cssExtra} style={{color: fontColor}}>\n                <Visualizer value={res} />\n                <div>\n                {getNote(variables?.i || 0)}\n                {renderVariables(variables || {})}\n                </div>\n                \n                <div style={{color: fontColor, fontSize: '2em'}}>{instrumentName}</div>\n            </div>\n            {error && <div style={{color: 'red'}}>{error.description}</div>}\n        </>\n    )\n}\n\nexport default ExpressionContent\n","/**\n * Sin function normalized to 0-1 cycle input, 0-1 return\n */\nconst normalizedSin = (x: number) => Math.sin(x * Math.PI * 2) / 2 + 0.5\n\n/**\n * input is period\n */\n// const timeSin = TODO\n\nconst normalizedTriangle = (x: number) => (x % 1) < 0.5 ? x % 1 * 2 : 1 - (x % 1 - 0.5) * 2\n\nconst normalizedSquare = (x: number, phase: number = 0.5) => x % 1 > phase ? 1 : 0\n\nconst invert = (x: number) => 1 - x\n\nconst lerp = (from: number, to: number, alpha: number = 0.5) => from * invert(alpha) + to * alpha\n\nconst normalizedStep = (position: number, ...steps: number[]) => {\n    const len = steps.length\n    const pos = Math.floor(position * len) % len\n    return steps[pos]\n}\n\nexport {normalizedSin, normalizedTriangle, normalizedSquare, invert, lerp, normalizedStep }","\nimport { compile, parse } from 'expression-eval'\nimport { useContext, useEffect, useRef, useState } from 'react'\nimport * as Tone from 'tone'\nimport ConfigContext from './ConfigContext'\nimport { invert, lerp, normalizedSin, normalizedSquare, normalizedStep, normalizedTriangle } from './functions'\nimport { getNote, getNoteFrequency } from './notes'\nimport ParseError from './ParseError'\nimport { ExpressionHookFunction } from './types'\nimport useAnimationFrame from './useAnimationFrame'\n\nconst useExpressionWithSound: ExpressionHookFunction = (expression: string, variables?: { [key: string]: number }) => {\n    const { volume } = useContext(ConfigContext)\n    const [res, setRes] = useState(0)\n\n    // const [uptime, setUptime] = useState(0)\n    // useAnimationFrame((time) => {setUptime(ut => ut + time / 1000)})\n    useAnimationFrame((time) => {\n        setRes(resRef.current)\n        // setUptime(ut => ut + time / 1000)\n    })\n\n    \n    \n    // const lastValidAst = useRef(parse('0'))\n    const lastValidCompiled = useRef<(context: object) => any>(() => {return 0.5})\n    const parseError = useRef<ParseError>(null)\n\n    useEffect(() => {\n        try {\n            // const ast = parse(expression)\n            // lastValidAst.current = ast\n            lastValidCompiled.current = compile(expression)\n            parseError.current = null\n        } catch(e) {\n            parseError.current = e as ParseError\n        }\n    }, [expression])\n    \n\n    // #region AUDIO\n\n    // Trigger notes - didn't sound half bad\n    const prevRes = useRef(0)\n    const synth = useRef<Tone.Synth<Tone.SynthOptions> | null>(null)\n\n    const resRef = useRef(0)\n\n    useEffect(() => {\n        synth.current = new Tone.Synth().toDestination()\n        return () => {\n            synth.current?.disconnect().dispose()\n        }\n    }, [])\n    \n    const osc = useRef<Tone.Oscillator | null>(null)\n    useEffect(() => {\n        osc.current = new Tone.Oscillator({\n            // frequency: 32 * Math.pow(2, variables.i),\n            frequency: getNoteFrequency(variables?.i || 0),\n            type: \"sine\",\n            // type: \"square\",\n            volume: -30,\n            detune: Math.random() * 30 - 15,\n        }).toDestination().start()\n\n        const clamp = (x: number) => Math.max(Math.min(x, 1), -1)\n\n        const loop = new Tone.Loop(time => {\n            // const exprEvalRes = evalast(lastValidAst.current, {time, t: time, sin: normalizedSin, tri: normalizedTriangle, sqr: normalizedSquare, stp: normalizedStep, inv: invert, ...variables})\n            const exprEvalRes = lastValidCompiled.current({time, t: time, sin: normalizedSin, tri: normalizedTriangle, sqr: normalizedSquare, stp: normalizedStep, inv: invert, ...variables})\n            resRef.current = typeof exprEvalRes === 'number' ? clamp(exprEvalRes) : 0 // evalast may return strings, functions, ...\n            // resRef.current = Math.sin(time) / 2 + 0.5\n\n            if (resRef.current - prevRes.current > 0.95 && synth.current && volume) {\n                synth.current.triggerAttackRelease(getNote(variables?.i || 0), \"8n\", time, volume.current)\n            }\n            prevRes.current = resRef.current\n\n            if (isNaN(resRef.current) || !osc.current || !volume) return\n            const volumeTarget = resRef.current === 0 ? -Infinity : lerp(-30, lerp(-30, 0, volume.current), Math.abs(resRef.current))\n            \n            osc.current.volume.rampTo(volumeTarget, 0.06, time)\n            // osc.current.type = resRef.current >= 0 ? 'sine' : 'square'\n            \n        }, \"0.03\").start(0);\n\n\n        return () => {\n            osc.current?.disconnect().dispose()\n            loop.dispose()\n        }\n    }, [])\n\n    return { res, error: parseError.current, instrumentName: 'synth' }\n}\n\nexport default useExpressionWithSound","/**\n *\n *       * ******* *\n *       *         *\n *       *   .5    *\n *       *         *\n *       * ******* *\n *\n */\n\n//useAnimationFrame((time) => {setDimmer(state => (state + time / 1000) % 1)})\n\n// TODO multiple preset animations\n// TODO beat sync\n// TODO rounded corners\n// TODO expression evaluation\n// TODO saving expression as preset\n// TODO persisting presets\n// TODO live sync of presets / selection (fbase realtime db?)\n// TODO support 2x not just 2*x\n// TODO input bg on focus\n// TODO shared globals (exposed to users)\n// TODO graph display\n// TODO deterministic noise functions\n// TODO splittable squrs\n// TODO keyboard func ~ key.a / key('a') / variable for few special keys / gamepad\n// TODO ...\n\nimport React, { ReactElement, useState } from \"react\"\nimport EmptySqur from \"./EmptySqur\"\nimport ExpressionContent from \"./ExpressionContent\"\nimport SqurProps from \"./SqurProps\"\nimport useExpressionSequencer from \"./useExpressionSequencer\"\nimport useExpressionWithSound from \"./useExpressionWithSound\"\n\n// const COLOR = '#72dec2'\n// const COLOR_RGB = '114, 222, 194'\n// const COLOR_RGB = '255, 0, 255'\nconst COLOR_RGB = \"170, 187, 204\"\n\n// const com = (a: any[]) => a.map(e => e.toString()).join(',')\n\n// const dim = (val: number) => {\n//     const v = val * 255\n//     return {background: `rgb(${com([v, v, v])})`}\n// }\n\nconst trns = (a: number) => ({ background: `rgba(${COLOR_RGB}, ${a})` })\nconst black = (a: number) => ({ background: `rgba(0,0,0, ${a})` })\n\nfunction Squr({\n  init,\n  side = 100,\n  expression: expressionExternal,\n  setExpression: setExpressionExternal,\n  variables = {},\n  contentComponent = ExpressionContent,\n  useExpressionHook = useExpressionWithSound\n}: SqurProps): ReactElement {\n  const [expressionInternal, setExpressionInternal] = useState(init || \"0\")\n  const expression = expressionExternal ?? expressionInternal\n  const setExpression = setExpressionExternal ?? setExpressionInternal\n\n  // const { res, error, instrumentName } = useExpressionWithSound(expression, variables)\n  // const { res, error, instrumentName } = useExpressionSequencer(expression, variables)\n  const { res, error, instrumentName, extra } = useExpressionHook(expression, variables)\n\n  const fontColor = res < 0.5 ? \"#abc\" : \"#444\"\n  const color = res > 0 ? trns(res) : black(-res)\n\n  const ContentComponent = contentComponent\n\n  return (\n    <EmptySqur color={color} side={side}>\n      <ContentComponent\n        side={side}\n        expression={expression}\n        setExpression={setExpression}\n        res={res}\n        fontColor={fontColor}\n        variables={variables}\n        error={error}\n        instrumentName={instrumentName}\n        extra={extra}\n      />\n    </EmptySqur>\n  )\n}\n\nexport default Squr\n","import React, { ReactElement, useEffect, useState } from 'react'\nimport Squr from './Squr'\n\nimport 'firebase/database'\nimport { useDatabase, useDatabaseObjectData } from 'reactfire'\nimport SqurProps from './SqurProps'\n\ninterface SqurFirebaseProps extends Omit<SqurProps, 'expression' | 'setExpression'> {\n    path?: string\n}\n\nfunction SqurFirebase({side, path = '/squr', ...rest}: SqurFirebaseProps): ReactElement {\n    const ref = useDatabase().ref(path)\n\n    const { data, status } = useDatabaseObjectData<{expr: string}>(ref)\n    \n    // TODO debounce\n    const setExpression = (newExpression: string) => {\n        setLocalExpression(newExpression)\n        ref.set({expr: newExpression})\n    }\n\n    // Optimistic updates and fix for cursor jumping (https://github.com/facebook/react/issues/955)\n    const [localExpression, setLocalExpression] = useState('.5')\n    useEffect(() => {\n        if (status === 'success' && data.expr !== localExpression) setLocalExpression(data.expr ?? '.5')\n    }, [status, data])\n\n    return (\n        <Squr side={side} expression={localExpression} setExpression={setExpression} {...rest} />\n    )\n}\n\nexport default SqurFirebase\n","import React from 'react'\n\nconst TimeContext = React.createContext(0)\n\nexport { TimeContext }\n","import { ExpressionHookFunction } from \"./types\";\nimport * as Tone from 'tone'\nimport { useEffect, useRef, useState } from \"react\";\n\n\nconst useExpressionSequencer: ExpressionHookFunction = (expression: string, variables?: { [key: string]: number }) => {\n    const steps = useRef<number[]>([0])\n    const [step, setStep] = useState(0)\n\n    useEffect(() => {\n        const mappedSteps = expression.split(',').map(str => {\n            const val = +str\n            return isNaN(val) ? 0 : val\n        })\n\n        steps.current = mappedSteps || [0]\n    }, [expression])\n\n    const [res, setRes] = useState(0)\n\n    const noise = useRef<Tone.Noise | null>(null)\n    useEffect(() => {\n        noise.current = new Tone.Noise(\"white\").toDestination()\n        noise.current.volume.rampTo(-30, 0)\n\n        const loopA = new Tone.Loop(time => {\n            const stepIndex = Math.round(time * 4) % steps.current.length\n            const currentStep = steps.current[stepIndex]\n            setStep(stepIndex)\n            \n            const playing = currentStep >= Math.random()\n\n            setRes(playing ? 0.5 : 0)\n            if (playing) noise.current?.start(time).stop(\"+32n\");\n        }, \"8n\").start(0);\n        \n        return () => {\n            noise.current?.dispose()\n            loopA.dispose()\n        }\n    }, [])\n\n    return { res, error: null, instrumentName: 'sequencer', extra: {step} }\n\n}\n\nexport default useExpressionSequencer","import { useState } from \"react\"\nimport useAnimationFrame from \"./Squr/useAnimationFrame\"\n\n// TODO allow refing other times\n// TODO time controls (reffable, context)\nconst useTime = (init: number = 0) => {\n    const [time, setTime] = useState(init)\n  useAnimationFrame(time => setTime(ut => ut + time / 1000))\n\n  return time\n}\n\nexport default useTime","import React, { useState } from \"react\"\nimport { FirebaseAppProvider } from \"reactfire\"\nimport * as Tone from 'tone'\nimport \"./App.css\"\nimport firebaseConfig from \"./firebaseConfig\"\nimport Help from \"./Help/Help\"\nimport Intro from \"./Intro/Intro\"\nimport ConfigContextProvider from \"./Squr/ConfigContextProvider\"\nimport SequencerContent from \"./Squr/SequencerContent\"\nimport SqurFirebase from \"./Squr/SqurFirebase\"\nimport { TimeContext } from \"./Squr/TimeContext\"\nimport useExpressionSequencer from \"./Squr/useExpressionSequencer\"\nimport useTime from \"./useTime\"\n\n// TODO make this also syncd\nconst SQURS_PER_ROW = 2\nconst SQURS_PER_COL = SQURS_PER_ROW\n\nconst SQURS = SQURS_PER_ROW * SQURS_PER_COL\nconst SIDE = `${80 / SQURS_PER_ROW}vmin`\n\nconst getXIndex = (index: number, perRow = SQURS_PER_ROW) => index % perRow\nconst getYIndex = (index: number, perRow = SQURS_PER_ROW) =>\n  Math.round(index / perRow)\n\nconst makeSqurs = (count: number) => {\n  const a = new Array(count).fill(1)\n  return a.map((_v, index) => {\n    // const content = index > 3 ? SequencerContent : undefined\n    // const isSequencer = index === a.length \n    const isSequencer = index > 1 \n    const content = isSequencer ? SequencerContent : undefined\n    const processing = isSequencer ? useExpressionSequencer : undefined\n\n    return (\n    <SqurFirebase\n      key={index}\n      side={SIDE}\n      path={`/squrs/${index}`}\n      contentComponent={content}\n      useExpressionHook={processing}\n      variables={{\n        i: index + 1,\n        x: getXIndex(index) + 1,\n        y: getYIndex(index) + 1,\n      }}\n    />\n  )})\n}\n\nconst dynamicFirebaseSqurs = makeSqurs(SQURS)\n\nfunction App() {\n  const time = useTime()\n  const [started, setStarted] = useState(false)\n\n  return (\n    <FirebaseAppProvider firebaseConfig={firebaseConfig}>\n      <ConfigContextProvider>\n        <TimeContext.Provider value={time}>\n          {/* TODO Redo with minimal grid based centering */}\n          {/* TODO gif animation credit */}\n          <div\n            style={{\n              display: \"flex\",\n              height: \"100vh\",\n              width: \"100vw\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n            }}\n          >\n            {started ? (\n              <div\n                style={{\n                  display: \"grid\",\n                  gridTemplateColumns: `repeat(${SQURS_PER_ROW}, ${SIDE})`,\n                  gap: \"2vmin\",\n                }}\n              >\n                <Help />\n                {dynamicFirebaseSqurs}\n              </div>\n            ) : (\n              <Intro onClick={() => {\n                setStarted(true)\n                Tone.start()\n                Tone.Transport.start()\n              }} />\n            )}\n          </div>\n        </TimeContext.Provider>\n      </ConfigContextProvider>\n    </FirebaseAppProvider>\n  )\n}\n\nexport default App\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}